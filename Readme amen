CREATE OR REPLACE PROCEDURE call_web_service(
  p_url IN VARCHAR2,
  p_content_type IN VARCHAR2,
  p_timeout IN NUMBER,
  p_response OUT CLOB
) AS
  req UTL_HTTP.REQ;
  resp UTL_HTTP.RESP;
BEGIN
  req := UTL_HTTP.BEGIN_REQUEST(p_url, 'GET', 'HTTP/1.1');
  UTL_HTTP.SET_HEADER(req, 'Content-Type', p_content_type);
  UTL_HTTP.SET_TRANSFER_TIMEOUT(p_timeout);
  resp := UTL_HTTP.GET_RESPONSE(req);
  DBMS_LOB.CREATETEMPORARY(p_response, TRUE);
  BEGIN
    LOOP
      UTL_HTTP.READ_TEXT(resp, p_response, 32767);
    END LOOP;
  EXCEPTION
    WHEN UTL_HTTP.END_OF_BODY THEN
      UTL_HTTP.END_RESPONSE(resp);
  END;
END;

